{{ 'component-card.css' | asset_url | stylesheet_tag }}
{{ 'component-price.css' | asset_url | stylesheet_tag }}

{{ 'component-slider.css' | asset_url | stylesheet_tag }}
{{ 'template-collection.css' | asset_url | stylesheet_tag }}


{%- liquid
  assign products_to_display = section.settings.collection.all_products_count

  if section.settings.collection.all_products_count > section.settings.products_to_show
    assign products_to_display = section.settings.products_to_show
    assign more_in_collection = true
  endif

  assign columns_mobile_int = section.settings.columns_mobile | plus: 0
  assign show_mobile_slider = false
  if section.settings.swipe_on_mobile and products_to_display > columns_mobile_int
    assign show_mobile_slider = true
  endif

  assign show_desktop_slider = false
  if section.settings.enable_desktop_slider and products_to_display > section.settings.columns_desktop
    assign show_desktop_slider = true
  endif
-%}

<div class="color-{{ section.settings.color_scheme }} isolate gradient">
  <div class="collection section-{{ section.id }}-padding page-width">
    <h2 class="feature-collection-title inline-richtext {% if settings.animations_reveal_on_scroll %} scroll-trigger animate--slide-in{% endif %}">
      {{ section.settings.title }}
    </h2>

    <slider-component class="slider-mobile-gutter slider-component-full-width{% if show_mobile_slider == false %} page-width{% endif %}{% if show_desktop_slider == false %} page-width-desktop{% endif %}{% if show_desktop_slider %} slider-component-desktop{% endif %} {% if settings.animations_reveal_on_scroll %} scroll-trigger animate--slide-in{% endif %}">
      <ul
        id="Slider-{{ section.id }}"
        class="grid product-grid contains-card contains-card--product{% if settings.card_style == 'standard' %} contains-card--standard{% endif %} grid--{{ section.settings.columns_desktop }}-col-desktop{% if section.settings.collection == blank %} grid--2-col-tablet-down{% else %} grid--{{ section.settings.columns_mobile }}-col-tablet-down{% endif %}{% if show_mobile_slider or show_desktop_slider %} slider{% if show_desktop_slider %} slider--desktop{% endif %}{% if show_mobile_slider %} slider--tablet grid--peek{% endif %}{% endif %}"
        role="list"
        aria-label="{{ 'general.slider.name' | t }}">
        {%- for product in section.settings.collection.products limit: section.settings.products_to_show -%}
          <li
            id="Slide-{{ section.id }}-{{ forloop.index }}"
            class="grid__item slider__slide {% if settings.animations_reveal_on_scroll %} scroll-trigger animate--slide-in{% endif %}"
            data-cascade
            style="--animation-order: {{ forloop.index }};">
            {% render 'top-card-product'
             , card_product: product,
             section_id: section.id %}
          </li>
        {%- endfor -%}
      </ul>

      <div class="top-feature-collection-btn slider-buttons no-js-hidden">
        <button
          type="button"
          class="slider-button slider-button--prev"
          name="previous"
          aria-label="{{ 'general.slider.previous_slide' | t }}"
          aria-controls="Slider-{{ section.id }}">
          {% render 'icon-pre-btn' %}
        </button>
        <button
          type="button"
          class="slider-button slider-button--next"
          name="next"
          aria-label="{{ 'general.slider.next_slide' | t }}"
          aria-controls="Slider-{{ section.id }}">
          {% render 'icon-next-btn' %}
        </button>
      </div>
    </slider-component>
  </div>
</div>

{% schema %}
  {
    "name": "Top featured collection",
    "tag": "section",
    "class": "section",
    "disabled_on": {
      "groups": ["header", "footer"]
    },
    "settings": [
      {
        "type": "inline_richtext",
        "id": "title",
        "default": "Featured collection",
        "label": "t:sections.featured-collection.settings.title.label"
      },
      {
        "type": "collection",
        "id": "collection",
        "label": "t:sections.featured-collection.settings.collection.label"
      },
      {
        "type": "range",
        "id": "products_to_show",
        "min": 2,
        "max": 25,
        "step": 1,
        "default": 4,
        "label": "t:sections.featured-collection.settings.products_to_show.label"
      },
      {
        "type": "range",
        "id": "columns_desktop",
        "min": 1,
        "max": 5,
        "step": 1,
        "default": 4,
        "label": "t:sections.featured-collection.settings.columns_desktop.label"
      }, {
        "type": "checkbox",
        "id": "enable_desktop_slider",
        "label": "t:sections.featured-collection.settings.enable_desktop_slider.label",
        "default": false
      }, {
        "type": "color_scheme",
        "id": "color_scheme",
        "label": "t:sections.all.colors.label",
        "info": "t:sections.all.colors.has_cards_info",
        "default": "background-1"
      }, {
        "type": "header",
        "content": "t:sections.featured-collection.settings.header.content"
      }, {
        "type": "header",
        "content": "t:sections.featured-collection.settings.header_mobile.content"
      }, {
        "type": "select",
        "id": "columns_mobile",
        "default": "2",
        "label": "t:sections.featured-collection.settings.columns_mobile.label",
        "options": [
          {
            "value": "1",
            "label": "t:sections.featured-collection.settings.columns_mobile.options__1.label"
          }, {
            "value": "2",
            "label": "t:sections.featured-collection.settings.columns_mobile.options__2.label"
          }
        ]
      }, {
        "type": "checkbox",
        "id": "swipe_on_mobile",
        "default": false,
        "label": "t:sections.featured-collection.settings.swipe_on_mobile.label"
      }
    ],
    "presets": [
      {
        "name": "t:sections.featured-collection.presets.name"
      }
    ]
  }
{% endschema %}


<style>

  .collection {
    padding-top: 12rem;
    padding-bottom: 12rem;
  }

  @media screen and (max-width: 800px) {
    .collection {
      padding-top: 6rem;
      padding-bottom: 6rem;
    }
  }

  .feature-collection-title {
    color: #595757;
    font-family: Noto Sans JP;
    font-size: 2rem;
    font-style: normal;
    font-weight: 400;
    padding-bottom: 2.6rem;
    border-bottom: rgb(208 208 208) solid 1px;
    margin-bottom: 5rem !important;
    margin-top: unset !important;
  }

  .collection slider-component {
    position: relative;
    padding-bottom: 2rem;
  }

  @media screen and (max-width: 749px) {
    /* Fix to show some space at the end of our sliders in all browsers */
    .collection .grid--peek.slider:after {
      margin-left: calc(-1 * var(--grid-mobile-horizontal-spacing));
    }

    .collection .grid--peek.slider .grid__item:first-of-type {
      margin-left: 2.5rem;
    }


    /* css for top feature slide */
    .collection .slider--tablet.grid--peek.grid--2-col-tablet-down .grid__item,
    .collection .grid--peek .grid__item {
      width: calc(50% - var(--grid-mobile-horizontal-spacing));
    }

  }
  .collection slider-component ul {
    padding-bottom: 2rem !important;
  }
  .top-feature-collection-btn {
    position: absolute;
    display: flex;
    justify-content: space-between;
    width: 100%;
    margin: 0 -1.6rem;
    transform: translateX(-50%) translateY(-50%);
    top: 40%;
    left: 50%;
  }

  @media screen and (max-width: 649px) {
    .top-feature-collection-btn {
      display: none !important;
    }

  }
  /* show scroll bar */
  .collection .slider {
    scrollbar-color: rgb(var(--color-foreground)) rgba(var(--color-foreground), 0.04);
    -ms-overflow-style: auto;
    scrollbar-width: thin;
  }

  .collection .slider::-webkit-scrollbar {
    margin-top: 1rem;
    height: 0.3rem;
    width: 0.3rem;
    display: initial;
  }

  .collection .slider::-webkit-scrollbar-thumb {
    color: #595757 !important;
  }
</style>